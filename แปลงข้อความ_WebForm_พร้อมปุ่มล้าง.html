
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</title>
  <style>
    body { font-family: 'Prompt', sans-serif; background: #f6f6f6; padding: 2rem; }
    .container { background: #fff; max-width: 760px; margin: auto; padding: 2rem; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    textarea, select, button { width: 100%; padding: 1rem; border-radius: 5px; border: 1px solid #ccc; margin-bottom: 1rem; }
    button.convert { background: #4CAF50; color: white; }
    button.copy { background: #2196F3; color: white; }
    button.clear { background: #f44336; color: white; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 5px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <div class="container">
    <h2>üì¶ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h2>

    <label for="productLine">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
    <select id="productLine">
      <option value="‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 1 ‡πÅ‡∏ñ‡∏° 2 / 50ml. / 1 / 0">‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 1 ‡πÅ‡∏ñ‡∏° 2</option>
      <option value="‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 2 ‡πÅ‡∏ñ‡∏° 4 / 50ml. / 1 / 0">‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 2 ‡πÅ‡∏ñ‡∏° 4</option>
      <option value="‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 3 ‡πÅ‡∏ñ‡∏° 6 / 50ml. / 1 / 0">‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 3 ‡πÅ‡∏ñ‡∏° 6</option>
      <option value="Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 1 ‡πÅ‡∏ñ‡∏° 1 / 100ml. / 1 / 0">Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 1 ‡πÅ‡∏ñ‡∏° 1</option>
      <option value="Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 2 ‡πÅ‡∏ñ‡∏° 2 / 100ml. / 1 / 0">Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 2 ‡πÅ‡∏ñ‡∏° 2</option>
      <option value="Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 3 ‡πÅ‡∏ñ‡∏° 3 / 100ml. / 1 / 0">Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 3 ‡πÅ‡∏ñ‡∏° 3</option>
    </select>

    <label for="pageLine">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à/‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ã‡πá‡∏õ‡∏ï‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
    <select id="pageLine">
      <option value="‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á Dr.YuTitan">‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á Dr.YuTitan</option>
      <option value="Kreain Nature ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡∏Ç‡πâ‡∏≠">Kreain Nature ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡∏Ç‡πâ‡∏≠</option>
    </select>

    <textarea id="inputText" placeholder="‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
    <button class="convert" onclick="convertText()">‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
    <button class="clear" onclick="clearForm()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <pre id="output"></pre>
    <button class="copy" onclick="copyResult()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
  </div>

  <script>
    function convertText() {
      const lines = document.getElementById("inputText").value.split("\n").map(l => l.trim()).filter(Boolean);
      const product = document.getElementById("productLine").value;
      const page = document.getElementById("pageLine").value;
      const map = { id: '', name: '', cod: '', address: '', phone: '', fb: '', admin: '', zip: '', province: '', tambon: '', amphur: '' };

      for (let i = 0; i < lines.length; i++) {
        const line = lines[i];
        if (!map.id && /^K\d+/.test(line)) { map.id = line.trim(); map.name = lines[++i]?.trim(); }
        else if (/COD[:Ôºö]/i.test(line)) { const m = line.match(/(\d+)/); if (m) map.cod = m[1]; }
        else if (/\d{9,}/.test(line)) { map.phone = line.match(/\d{9,}/)?.[0]; }
        else if (/Fb[:Ôºö]/i.test(line)) { map.fb = line.split(/[:Ôºö]/)[1]?.trim(); }
        else if (/Admin[:Ôºö]/i.test(line)) { map.admin = line.split(/[:Ôºö]/)[1]?.trim(); }
        else if (/\d{5}$/.test(line)) {
          map.zip = line.match(/\d{5}$/)[0];
          const p = line.match(/‡∏à\.?\s*(\S+)/); if (p) map.province = p[1];
          const clean = line.replace(/‡∏à\..*/g, '').replace(/\d{5}/, '').replace(/üìå.*$/, '').replace(/Pg:.*$/, '').trim();
          map.address += (map.address ? ' ' : '') + clean;
        } else if (/‡∏ï\./.test(line)) {
          const t = line.match(/‡∏ï\.(\S+)/); if (t) map.tambon = '‡∏ï.' + t[1];
          map.address += (map.address ? ' ' : '') + line;
        } else if (/‡∏≠\./.test(line)) {
          const a = line.match(/‡∏≠\.(\S+)/); if (a) map.amphur = a[1];
        } else if (!line.includes("üìå") && !line.includes("Pg:")) {
          map.address += (map.address ? ' ' : '') + line;
        }
      }

      const fullAddress = map.tambon
        ? map.amphur === '‡πÄ‡∏°‡∏∑‡∏≠‡∏á' && map.province
          ? `${map.address} ,‡∏≠.${map.amphur}${map.province}`
          : `${map.address} ‡∏≠.${map.amphur}`
        : map.address;

      const today = new Date().toISOString().split("T")[0];
      const output = [
        `=${map.id}.${map.name}`,
        `=${product}`,
        `=COD/${map.cod}`,
        `=${fullAddress}`,
        `=${map.province}`,
        `=${map.zip}`,
        `=${map.phone}`,
        `=${map.fb}`,
        `=${map.admin}`,
        `=${page}`,
        `=${today}`
      ];
      document.getElementById("output").textContent = output.join("\n");
    }

    function copyResult() {
      const text = document.getElementById("output").textContent;
      navigator.clipboard.writeText(text).then(() => {
        alert("‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
      });
    }

    function clearForm() {
      document.getElementById("inputText").value = "";
      document.getElementById("output").textContent = "";
    }
  </script>
</body>
</html>
